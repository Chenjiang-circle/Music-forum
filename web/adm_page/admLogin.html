<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>管理员登录</title>
    <!-- 新 Bootstrap 核心 CSS 文件 -->
    <link href="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet">

    <!-- jQuery文件。务必在bootstrap.min.js 之前引入 -->
    <script src="https://cdn.staticfile.org/jquery/2.1.1/jquery.min.js"></script>
    <script src="https://cdn.staticfile.org/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>

    <!-- 最新的 Bootstrap 核心 JavaScript 文件 -->
    <script src="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <link rel="stylesheet" href="./css/admLogin.css">
    
    <style>

    </style>
</head>

<body>
    <div class="container-fluid">
        <div class="row">
            <form id="form" name="f">
                <h3>登录你的管理员账户</h3><br>
                <div class="form-group">
                    <label>账户名：</label>
                    <input name="userId" type="text" placeholder="输入账户名" required class="form-control" id="username">
                </div>
                <div class="form-group">
                    <label>密码：</label>
                    <input type="password" name="pass" placeholder="请输入密码" required class="form-control" id="password">
                </div>
                <div class="foor">
                    <div style="float:left"><span>还没有账号？</span></div>
                    <div style="float:right"><span>忘记密码</span></div>
                </div>

                <input type="button" value="登录" class="btn btn-default" id="loginBtn">
                <div class="login_msg">错误信息</div>
            </form>
            <script>
                $(document).ready(function () {
                    $("#loginBtn").click(function () {
                        if ($("#username").val() == "") {
                            $(".login_msg").html("请输入你的账户名")
                        } else if ($("#password").val() == "") {
                            $(".login_msg").html("请输入你的密码")
                        } else {
                            $.ajax({
                                url: "http://172.20.151.112:8066/Music_forum/enterservlet",
                                data: {
                                    "userid": $("#username").val(),
                                    "password": $("#password").val()
                                },
                                type: "get",
                                success: function (str) {
                                    var data= eval("("+str+")");
                                    $.cookie("user",data.userid,{expirers:7,path:'/'});
                                    $.cookie("image", data.url, {expirers:7,path:'/'});
                                    if (data.pass == true) {
                                        alert("登入成功");
                                        window.document.f.action = "./administrator.html";
                                        window.document.f.submit();
                                    } else {
                                        $(".login_msg").html("账户名或密码有问题，请检查")
                                    }

                                },
                                error: function(err) {
                                    $(".login_msg").html("网络似乎有点问题")
                                    console.log(err)
                                }
                            })
                        }
                    })
                })
            </script>
        </div>

    </div>
</body>

</html>